<!DOCTYPE html><html><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="alternative" href="/atom.xml" title="andforce" type="application/atom+xml"><link rel="icon" href="/favicon.png"><title>android_usb_devices - andforce</title><link rel="stylesheet" href="/css/main.css" type="text/css"><!--[if lt IE 9]><script>(function(a,b){a="abbr article aside audio bdi canvas data datalist details dialog figcaption figure footer header hgroup main mark meter nav output progress section summary template time video".split(" ");for(b=a.length-1;b>=0;b--)document.createElement(a[b])})()</script><![endif]--></head><body><header class="head"><h1 class="head-title u-fl"><a href="/">andforce</a></h1><nav class="head-nav u-fr"><ul class="head-nav__list"><li class="head-nav__item"><a href="/archives" class="head-nav__link">文章</a></li><li class="head-nav__item"><a href="http://weibo.com/andforce" class="head-nav__link">微博</a></li><li class="head-nav__item"><a href="https://github.com/andforce" class="head-nav__link">GitHub</a></li><li class="head-nav__item"><a href="https://bintray.com/andforce" class="head-nav__link">Bintray</a></li></ul></nav></header><main class="main"><article class="post"><header class="post__head"><time datetime="2015-10-21T10:45:52.000Z" class="post__time">October 21, 2015</time><h1 class="post__title"><a href="/2015/10/21/android-usb-devices/">android_usb_devices</a></h1><hr/></header><div class="post__main echo"><p>有时候android设备链接到电脑的时候会显示<code>error:insufficient permissions for device</code>,解决方法就是在<code>/etc/udev/rules.d/51-android.rules</code> 加入设备的<code>idVender</code>和<code>idProduct</code>,于是就有了下面这个自动添加的脚本.<br><figure class="highlight"><table><tr><td class="code"><pre><span class="line">#!/bin/bash&#10;RULES=/etc/udev/rules.d/51-android.rules&#10;TMP_USB_1=tmp_usb_1&#10;TMP_USB_2=tmp_usb_2&#10;TMP_USB=diff_usb&#10;&#10;echo -n &#34;&#35831;&#25226;&#25163;&#26426;&#38142;&#25509;&#30005;&#33041;&#21518;,&#25353;&#22238;&#36710;:&#34;&#10;&#10;read user_input&#10;lsusb &#62; $TMP_USB_1&#10;cat -n $TMP_USB_1&#10;&#10;echo -n &#34;&#35831;&#25226;&#25163;&#26426;&#25300;&#25481;&#21518;,&#25353;&#22238;&#36710;:&#34;&#10;read user_input&#10;&#10;lsusb &#62; $TMP_USB_2&#10;cat -n $TMP_USB_2&#10;&#10;diff $TMP_USB_1 $TMP_USB_2 &#62; $TMP_USB&#10;&#10;diff_usb_str=`sed -n &#39;2p&#39; $TMP_USB`&#10;#echo $&#123;diff_usb_str&#125;&#10;&#10;sub_str=$&#123;diff_usb_str:25:9&#125;&#10;#echo $sub_str&#10;&#10;idVendor=$&#123;sub_str:0:4&#125;&#10;idProduct=$&#123;sub_str:5:4&#125;&#10;&#10;insert=&#39;SUBSYSTEM==\&#34;usb\&#34;, ATTRS&#123;idVendor&#125;==\&#34;&#39;$&#123;idVendor&#125;&#39;\&#34;, ATTRS&#123;idProduct&#125;==\&#34;&#39;$&#123;idProduct&#125;&#39;\&#34;,MODE=\&#34;0666\&#34;&#39;&#10;&#10;sudo touch $RULES&#10;sudo sh -c &#34;echo $insert &#62;&#62; $RULES&#34;&#10;sudo chmod a+x $RULES&#10;&#10;echo -n &#34;&#35831;&#20877;&#27425;&#25226;&#25163;&#26426;&#38142;&#25509;&#30005;&#33041;,&#20043;&#21518;&#25353;&#22238;&#36710;:&#34;&#10;read user_input&#10;&#10;adb kill-server &#38;&#38; adb devices&#10;&#10;echo &#34;&#30475;&#21040;&#35774;&#22791;&#34920;&#31034;&#24050;&#32463;&#25104;&#21151;&#20102;,&#22914;&#26524;&#36824;&#26159;&#27809;&#26377;&#26174;&#31034;&#27491;&#24120;,&#37325;&#21551;&#19968;&#19979;&#30005;&#33041;&#23601;&#22909;&#20102;&#34;&#10;&#10;rm $TMP_USB $TMP_USB_1 $TMP_USB_2</span><br></pre></td></tr></table></figure></p>
<h3 id="使用方法">使用方法</h3><blockquote>
<p>把上面脚本内容保存到<code>usb.sh</code>中,执行<code>bash usb.sh</code>就行.</p>
</blockquote>
</div><footer class="post__foot u-cf"><a class="post__foot-link u-fr"></a></footer></article></main><footer class="foot"><div class="foot-copy u-fl">&copy; 2015 andforce<bdi> Theme by <a href="https://github.com/andforce/hexo-theme-andforce" >andforce</a></bdi></div><menu class="page-menu u-fr"><li class="page-menu__item"><span title="Previous" class="page-menu__link icon-arrow-left page-menu__link--disabled"></span></li><li class="page-menu__item"><a title="Next" href="/2015/10/13/gitconfig/" class="page-menu__link icon-arrow-right"></a></li></menu></footer></body></html>